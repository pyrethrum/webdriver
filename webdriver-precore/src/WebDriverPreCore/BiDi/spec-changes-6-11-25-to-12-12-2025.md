# WebDriver BiDi Spec Changes (Nov 6, 2025 → Dec 12, 2025)

## Summary
Implementation-impacting changes between W3C Working Draft from November 6, 2025 and December 12, 2025.

---

## 1. Session Module Type Rename  :: N/A

**Description**: Renamed `session.SubscriptionRequest` to `session.SubscribeParameters` and clarified its purpose to only handle subscription requests (not unsubscription).

**CDDL**:
```cddl
session.SubscribeParameters = {
  events: [+text],
  ? contexts: [+browsingContext.BrowsingContext],
  ? userContexts: [+browser.UserContext],
}
```

**Impact**: Type name change affects the `session.subscribe` command parameters.

---

## 2. New Screen Settings Infrastructure

**Description**: Added screen settings data structures to support emulating screen dimensions.

**CDDL**:
```cddl
; A screen settings struct with dimensions
screen_settings = {
  height: integer,
  width: integer,
  x: integer,
  y: integer
}

; Remote end maintains screen settings overrides
screen_settings_overrides = {
  user_context_screen_settings: weak_map,  ; user contexts → screen settings
  navigable_screen_settings: weak_map      ; navigables → screen settings
}
```

**Impact**: Foundation for new `emulation.setScreenSettingsOverride` command.

---

## 3. New Command: `emulation.setScreenSettingsOverride`

**Description**: New command to emulate web-exposed screen area and available screen area for top-level traversables or user contexts.

**CDDL**:
```cddl
emulation.SetScreenSettingsOverride = (
  method: "emulation.setScreenSettingsOverride",
  params: emulation.SetScreenSettingsOverrideParameters
)

emulation.ScreenArea = {
  width: js-uint,
  height: js-uint
}

emulation.SetScreenSettingsOverrideParameters = {
  screenArea: emulation.ScreenArea / null,
  ? contexts: [+browsingContext.BrowsingContext],
  ? userContexts: [+browser.UserContext],
}

emulation.SetScreenSettingsOverrideResult = EmptyResult
```

**Impact**: Requires implementation of new command with screen dimension control per context.

---

## 4. Network Command Return Type Clarification :: N/A

**Description**: Changed `emulation.setNetworkConditions` from implicit `EmptyResult` to explicit named return type.

**CDDL**:
```cddl
emulation.SetNetworkConditionsResult = EmptyResult
```

**Impact**: Return type now has explicit name `emulation.SetNetworkConditionsResult`.

---

## Action Items

1. **Implement** `emulation.setScreenSettingsOverride` command with new screen area types
2. **Update** session subscribe implementation to use `session.SubscribeParameters` type name
3. **Add** screen settings infrastructure (weak maps for navigables and user contexts)
4. **Update** `emulation.setNetworkConditions` return type to named `emulation.SetNetworkConditionsResult`

---

## Statistics

- **Breaking changes**: 1 (type rename from `SubscriptionRequest` to `SubscribeParameters`)
- **New commands**: 1 (`emulation.setScreenSettingsOverride`)
- **New types**: 3 (`ScreenArea`, `SetScreenSettingsOverrideParameters`, `SetScreenSettingsOverrideResult`)
- **Return type changes**: 1 (`SetNetworkConditionsResult`)
