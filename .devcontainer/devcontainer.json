// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/docker-existing-dockerfile
{
	"name": "webdriver-precore",
	"image": "ghcr.io/pyrethrum/webdriver-precore-firefox:latest",

	// desktop-lite provides a virtual display (Xvfb + VNC + noVNC) so Firefox can render
	// its GUI inside the container. Users view it via browser at localhost:6080.
	// This works on all host OSes (Windows/macOS/Linux) without requiring X server setup.
	"features": {
		"ghcr.io/devcontainers/features/desktop-lite:1": {}
	},

	// Forward the noVNC web port so users can view the desktop in their browser
	"forwardPorts": [6080],
	"portsAttributes": {
		"6080": {
			"label": "Desktop (noVNC)"
		}
	},
	// copy the compiled library files from dist-newstyle into the current working directory
	// if the dist-newstyle directory does not already exist  this does not work
	// cabal is too clever about cache invalidation and rebuild anyway
	// "postCreateCommand": "[ ! -d ./dist-newstyle ] && cp -r ~/dist-newstyle ./",
	// Configure tool-specific properties.devco
	// "customizations": {},
	"remoteUser": "vscode",
	"containerUser": "vscode",

	"postStartCommand": "bash ./dev/container-start.sh",
	"postAttachCommand": "bash ./dev/container-attach.sh",
	
	

	"customizations": {
		"vscode": {
			"extensions": [
				"alefragnani.Bookmarks",
				"nemesv.copy-file-name",
				"mrmlnc.vscode-duplicate",
				"sleistner.vscode-fileutils",
				"huizhou.githd",
				"donjayamanne.githistory",
				"eamodio.gitlens",
				"haskell.haskell",
				"justusadam.language-haskell",
				"ms-vsliveshare.vsliveshare-pack",
				"christian-kohler.path-intellisense",
				"kylepaulsen.stack-tabs",
				"andyyaldoo.vscode-json",
				"redhat.vscode-yaml",
				"bee.git-temporal-vscode",
				"SanaAjani.taskrunnercode"
			]
		}
	}
}